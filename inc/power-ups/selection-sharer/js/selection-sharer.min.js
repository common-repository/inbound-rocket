!function(h){var i=function(e){var u=this;"string"==typeof(e=e||{})&&(e={elements:e}),this.sel=null,this.textSelection="",this.htmlSelection="",this.postId=null,this.appId=h('meta[property="fb:app_id"]').attr("content")||h('meta[property="fb:app_id"]').attr("value"),this.url2share=h('meta[property="og:url"]').attr("content")||h('meta[property="og:url"]').attr("value")||window.location.href,this.getSelectionText=function(e){var t="",n="";if((e=e||window.getSelection()).rangeCount){for(var o=document.createElement("div"),i=0,r=e.rangeCount;i<r;++i)o.appendChild(e.getRangeAt(i).cloneContents());n=o.textContent,t=o.innerHTML}u.textSelection=n,u.htmlSelection=t||n;var a=h(e.anchorNode).parents("article"),s=null;if(a.length){var l=a.attr("class").match(/post-(\d+)/);l&&(s=l[1])}return u.postId=s,n},this.selectionDirection=function(e){var t=e||window.getSelection(),n=document.createRange();if(!t.anchorNode)return 0;n.setStart(t.anchorNode,t.anchorOffset),n.setEnd(t.focusNode,t.focusOffset);var o=n.collapsed?"backward":"forward";return n.detach(),o},this.showPopunder=function(){u.popunder=u.popunder||document.getElementById("selectionSharerPopunder");var e=window.getSelection(),t=u.getSelectionText(e);if(e.isCollapsed||t.length<10||!t.match(/ /))return u.hidePopunder();if(u.popunder.classList.contains("fixed"))return u.popunder.style.bottom=0,u.popunder.style.bottom;var n=e.getRangeAt(0).endContainer.parentNode;if(u.popunder.classList.contains("show")){if(Math.ceil(u.popunder.getBoundingClientRect().top)==Math.ceil(n.getBoundingClientRect().bottom))return;return u.hidePopunder(u.showPopunder)}if(n.nextElementSibling)u.pushSiblings(n);else{u.placeholder||(u.placeholder=document.createElement("div"),u.placeholder.className="selectionSharerPlaceholder");var o=window.getComputedStyle(n).marginBottom;u.placeholder.style.height=o,u.placeholder.style.marginBottom=-2*parseInt(o,10)+"px",n.parentNode.insertBefore(u.placeholder)}var i=window.pageYOffset+n.getBoundingClientRect().bottom;u.popunder.style.top=Math.ceil(i)+"px",setTimeout(function(){u.placeholder&&u.placeholder.classList.add("show"),u.popunder.classList.add("show")},0)},this.pushSiblings=function(e){for(;e=e.nextElementSibling;)e.classList.add("selectionSharer"),e.classList.add("moveDown")},this.hidePopunder=function(e){if(e=e||function(){},"fixed"==u.popunder)return u.popunder.style.bottom="-50px",e();u.popunder.classList.remove("show"),u.placeholder&&u.placeholder.classList.remove("show");for(var t=document.getElementsByClassName("moveDown");el=t[0];)el.classList.remove("moveDown");setTimeout(function(){u.placeholder&&document.body.insertBefore(u.placeholder),e()},600)},this.show=function(r){setTimeout(function(){var e=window.getSelection(),t=u.getSelectionText(e);if(!e.isCollapsed&&t&&10<t.length&&t.match(/ /)){var n=e.getRangeAt(0).getBoundingClientRect().top-5+u.getPosition().y-u.$popover.height(),o=0;if(r)o=r.pageX;else{var i=e.anchorNode.parentNode;for(o+=i.offsetWidth/2;o+=i.offsetLeft,i=i.offsetParent;);}switch(h(".inboundrocket-ss-branding").fadeIn(),u.selectionDirection(e)){case"forward":o-=u.$popover.width();break;case"backward":o+=u.$popover.width();break;default:return}u.$popover.removeClass("anim").css("top",n+10).css("left",o).show(),setTimeout(function(){u.$popover.addClass("anim").css("top",n)},0)}},10)},this.hide=function(e){u.$popover.hide(),h(".inboundrocket-ss-branding").hide()},this.smart_truncate=function(e,t){if(!e||!e.length)return e;var n=e.length>t,o=n?e.substr(0,t-1):e;return o=n?o.substr(0,o.lastIndexOf(" ")):o,n?o+"...":o},this.getRelatedTwitterAccounts=function(){var e=[],t=h('meta[name="twitter:creator"]').attr("content")||h('meta[name="twitter:creator"]').attr("value");t&&e.push(t);for(var n=document.getElementsByTagName("a"),o=0,i=n.length;o<i;o++)if(n[o].attributes.href&&"string"==typeof n[o].attributes.href.value){var r=n[o].attributes.href.value.match(/^https?:\/\/twitter\.com\/([a-z0-9_]{1,20})/i);r&&1<r.length&&-1==["widgets","intent"].indexOf(r[1])&&e.push(r[1])}return 0<e.length?e.join(","):""},this.updateShareCount=function(e,t,n){h.ajax({url:inboundrocket_ss_js.ajaxurl,type:"post",dataType:"json",data:{nonce:inboundrocket_ss_js.nextNonce,action:"selection_sharer_track",postid:e,text:t,type:n}})},this.shareTwitter=function(i){i.preventDefault(),jQuery("body").prepend("<div id='ir_loading_wrap' style='position: fixed;top: 0;width: 100%;height: 100%;background: rgba(255, 255, 255, 0.5);z-index: 9999;'>Loading, please wait...</div>"),u.viaTwitterAccount||(u.viaTwitterAccount=jQuery('meta[name="twitter:site"]').attr("content")||jQuery('meta[name="twitter:site"]').attr("value")||"",u.viaTwitterAccount=u.viaTwitterAccount.replace(/@/,"")),u.relatedTwitterAccounts||(u.relatedTwitterAccounts=u.getRelatedTwitterAccounts());var r,a,s,l,c,d=null;jQuery.ajax({url:inboundrocket_ss_js.ajaxurl,type:"post",dataType:"json",data:{url:location.href,type:"twitter",nonce:inboundrocket_ss_js.nextNonce,action:"selection_sharer_shorturl"},success:function(e){d=e.shorturl,jQuery.ajax({url:inboundrocket_ss_js.ajaxurl,type:"post",dataType:"json",data:{nonce:inboundrocket_ss_js.nextNonce,action:"selection_sharer_settings"},success:function(e){if((r=u.textSelection.trim())||(r=u.text),l="",e.ir_ss_twitter_username&&(c=" via @"+e.ir_ss_twitter_username),e.ir_ss_tweet_suffix&&(l+=" "+e.ir_ss_tweet_suffix),s="",r.length<250&&null!=l&&void 0!==c?s=c+l:null!=l&&void 0===c?s=l:null!=c&&(s=c),250<r.length&&null==s)a=u.smart_truncate(r,230);else if(250<r.length&&null!=s){r.length,r.length,s.length;a=u.smart_truncate(r,224)}else r.length<250&&null!=s?a=u.smart_truncate(r,230):r.length<250&&null==s&&(a=u.smart_truncate(r,224));a+=s;var t="http://twitter.com/intent/tweet?text="+encodeURIComponent(a)+"&related="+u.getRelatedTwitterAccounts()+"&url="+encodeURIComponent(d);u.viaTwitterAccount&&r.length<224-u.viaTwitterAccount.length&&(t+="&via="+u.viaTwitterAccount);var n=screen.width/2-320,o=screen.height/2-220-100;return h("#ir_loading_wrap").remove(),void 0===window.share_twitter||window.share_twitter.closed||window.share_twitter.close(),window.open(t,"share_twitter","toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width=640, height=440, top="+o+", left="+n),u.hide(i),u.updateShareCount(u.postId,a,"twitter"),!1}})}})},this.shareLinkedIn=function(e){e.preventDefault();var t=u.htmlSelection.replace(/<p[^>]*>/gi,"\n").replace(/<\/p>|  /gi,"").trim(),n="https://www.linkedin.com/shareArticle?mini=true&url="+encodeURIComponent(u.url2share)+"&title="+encodeURIComponent(t),o=screen.width/2-320,i=screen.height/2-220-100;void 0===window.share_linkedin||window.share_linkedin.closed||window.share_linkedin.close(),window.open(n,"share_linkedin","toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width=640, height=440, top="+i+", left="+o),u.hide(e),u.updateShareCount(u.postId,t,"linkedin")},this.shareFacebook=function(e){e.preventDefault();var t=u.htmlSelection.replace(/<p[^>]*>/gi,"\n").replace(/<\/p>|  /gi,"").trim(),n="https://www.facebook.com/dialog/feed?app_id="+u.appId+"&display=popup&caption="+encodeURIComponent(t)+"&link="+encodeURIComponent(u.url2share)+"&href="+encodeURIComponent(u.url2share)+"&redirect_uri="+encodeURIComponent(u.url2share),o=screen.width/2-320,i=screen.height/2-220-100;void 0===window.share_facebook||window.share_facebook.closed||window.share_facebook.close(),window.open(n,"share_facebook","toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width=640, height=440, top="+i+", left="+o),u.hide(e),u.updateShareCount(u.postId,t,"facebook")},this.shareEmail=function(i){i.preventDefault(),jQuery("body").prepend("<div id='ir_loading_wrap' style='position: fixed;top: 0;width: 100%;height: 100%;background: rgba(255, 255, 255, 0.5);z-index: 9999;'>Loading, please wait...</div>");var r=null;jQuery.ajax({url:inboundrocket_ss_js.ajaxurl,type:"post",dataType:"json",data:{url:location.href,type:"email",nonce:inboundrocket_ss_js.nextNonce,action:"selection_sharer_shorturl"},success:function(e){r=e.shorturl;var t=u.textSelection.replace(/<p[^>]*>/gi,"\n").replace(/<\/p>|  /gi,"").trim(),n={},o=inboundrocket_ss_js.email_subject;if(o){n.subject=o.replace(/\[[^\[]*selection[^\]]*\]/gi,t),n.subject=o.replace(/\[[^\[]*title[^\]]*\]/gi,document.title)}else n.subject=encodeURIComponent("Quote from "+document.title);return h("#ir_loading_wrap").remove(),n.body=encodeURIComponent("“"+t+"”")+"%0D%0A%0D%0AFrom: "+document.title+"%0D%0A"+r,h(i.target).attr("href","mailto:?subject="+n.subject+"&body="+n.body),u.hide(i),u.updateShareCount(u.postId,t,"email"),!0}})},this.render=function(){if(inboundrocket_ss_js.bg_color)var e='style="background-color:'+inboundrocket_ss_js.bg_color+';background-image:none;"';var t='<div class="selectionSharer" id="selectionSharerPopover" style="position:absolute;">  <div id="selectionSharerPopover-inner" '+e+">    <ul>";"0"!=inboundrocket_ss_js.enable_tw&&(t+='<li><a class="action tweet" href="" title="Share this selection on Twitter" target="_blank">Tweet</a></li>'),"0"!=inboundrocket_ss_js.enable_fb&&(t+='<li><a class="action facebook" href="" title="Share this selection on Facebook" target="_blank">Facebook</a></li>'),"0"!=inboundrocket_ss_js.enable_li&&(t+='<li><a class="action linkedin" href="" title="Share this selection on LinkedIn" target="_blank">LinkedIn</a></li>'),"0"!=inboundrocket_ss_js.enable_em&&(t+='<li><a class="action email" href="" title="Share this selection by email" target="_blank"><svg width="20" height="20"><path stroke="#FFF" stroke-width="6" d="m16,25h82v60H16zl37,37q4,3 8,0l37-37M16,85l30-30m22,0 30,30"/></svg></a></li>'),t+='   </ul>  </div>  <div class="selectionSharerPopover-clip"><span class="selectionSharerPopover-arrow"></span></div></div><style type="text/css">#selectionSharerPopover .selectionSharerPopover-arrow {background-color:'+inboundrocket_ss_js.bg_color+";}</style>";var n='<div id="selectionSharerPopunder" class="selectionSharer">  <div id="selectionSharerPopunder-inner" '+e+">    <ul>";"0"!=inboundrocket_ss_js.enable_tw&&(t+='<li><a class="action tweet" href="" title="Share this selection on Twitter" target="_blank">Tweet</a></li>'),"0"!=inboundrocket_ss_js.enable_fb&&(t+='<li><a class="action facebook" href="" title="Share this selection on Facebook" target="_blank">Facebook</a></li>'),"0"!=inboundrocket_ss_js.enable_li&&(t+='<li><a class="action linkedin" href="" title="Share this selection on LinkedIn" target="_blank">LinkedIn</a></li>'),"0"!=inboundrocket_ss_js.enable_em&&(t+='<li><a class="action email" href="" title="Share this selection by email" target="_blank"><svg width="20" height="20"><path stroke="#FFF" stroke-width="6" d="m16,25h82v60H16zl37,37q4,3 8,0l37-37M16,85l30-30m22,0 30,30"/></svg></a></li>'),n+="  </ul>  </div></div>",n+='<style type="text/css">#selectionSharerPopunder .selectionSharerPopunder-arrow {background-color:'+inboundrocket_ss_js.bg_color+";}</style>",u.$popover=h(t),u.$popover.find("a.tweet").on("click",function(e){u.shareTwitter(e)}),u.$popover.find("a.linkedin").on("click",function(e){u.shareLinkedIn(e)}),u.$popover.find("a.facebook").on("click",function(e){u.shareFacebook(e)}),u.$popover.find("a.email").on("click",function(e){u.shareEmail(e)}),h("body").append(u.$popover),u.$popunder=h(n),u.$popunder.find("a.tweet").on("click",function(e){u.shareTwitter(e)}),u.$popunder.find("a.linkedin").on("click",function(e){u.shareLinkedIn(e)}),u.$popunder.find("a.facebook").on("click",function(e){u.shareFacebook(e)}),u.$popunder.find("a.email").on("click",function(e){u.shareEmail(e)}),h("body").append(u.$popunder),u.appId&&u.url2share&&h(".selectionSharer a.facebook").css("display","inline-block")},this.setElements=function(e){"string"==typeof e&&(e=h(e)),u.$elements=e instanceof h?e:h(e),u.$elements.on({mouseup:function(e){u.show(e)},mousedown:function(e){u.hide(e)},touchstart:function(e){u.isMobile=!0}}).addClass("selectionShareable"),document.onselectionchange=u.selectionChanged},this.selectionChanged=function(e){u.isMobile&&(u.lastSelectionChanged&&clearTimeout(u.lastSelectionChanged),u.lastSelectionChanged=setTimeout(function(){u.showPopunder(e)},300))},this.getPosition=function(){var e=void 0!==window.pageXOffset,t="CSS1Compat"===(document.compatMode||"");return{x:e?window.pageXOffset:t?document.documentElement.scrollLeft:document.body.scrollLeft,y:e?window.pageYOffset:t?document.documentElement.scrollTop:document.body.scrollTop}},this.render(),e.elements&&this.setElements(e.elements)};h.fn.selectionSharer=function(){return(new i).setElements(this),this},"function"==typeof define?define(function(){return i.load=function(e,t,n,o){(new i).setElements("p"),n()},i}):"object"==typeof module&&module.exports?module.exports=i:window.SelectionSharer=i}(jQuery),function(n){var t=new SelectionSharer("p");n(document.body).on("click",".shared",function(e){$options={e:e,sharer:t,id:n(".shared").data("id"),text:n(".shared").data("text")},n(".shared").selectionSharerShow($options)}),1==inboundrocket_ss_js.enable_frontend&&n.ajax({url:inboundrocket_ss_js.ajaxurl,type:"post",dataType:"json",data:{nonce:inboundrocket_ss_js.nextNonce,action:"selection_sharer_gettext"},success:function(e){n.each(e,function(e,t){n('*:contains("'+t.share+'")').each(function(){var e;n(this).children().length<1&&("0"!=inboundrocket_ss_js.enable_tw&&(e+='<span class="sharedSharesTwitter">'+t.twcount+"</span>"),"0"!=inboundrocket_ss_js.enable_fb&&(e+='<span class="sharedSharesFacebook">'+t.fbcount+"</span>"),"0"!=inboundrocket_ss_js.enable_li&&(e+='<span class="sharedSharesLinkedIn">'+t.licount+"</span>"),"0"!=inboundrocket_ss_js.enable_em&&(e+='<span class="sharedSharesEmail">'+t.emcount+"</span>"),n(this).html(n(this).text().replace(t.share,'<span class="shared" data-id="'+t.share_id+'" data-text="'+t.share+'">'+t.share+e+"</span>")))})})}})}(jQuery);